#=========================================
#   CIRCE INMS INMS_Script_FM_6v1_2020_07_10-08_22_44
#=========================================

# Power on INMS
puts("Powering on the payload...")

cmd("UUT SET_LOAD_SWITCH with SWITCH_NUM IO17_OUT_INMS_5V, STATUS ON")
cmd("UUT SET_LOAD_SWITCH with SWITCH_NUM IO7_OUT_INMS_3P3V, STATUS ON")
wait_check("UUT POWER IO17_OUT_INMS_5V == 'ON'",5)
wait_check("UUT POWER IO7_OUT_INMS_3P3V == 'ON'",5)

puts("INMS has been powered on")
wait(5)

# Send the SU_LDP command
cmd("UUT PAYLOAD_INMS_SU_LDP_DIRECT_CMD with PKT_LEN 56, PAYLOAD_ID 2, CMD_ID 5, LENGTH 51, SEQ_CNT 2, PARAM [119, 0, 2, 1, 10, 0, 2, 0, 113, 65, 18, 2, 20, 134, 232, 3, 232, 3, 64, 95, 9, 180, 0, 79, 10, 4, 0, 32, 3, 16, 99, 32, 32, 16, 59, 28, 66, 32, 32, 16, 59, 28, 66, 32, 212, 213, 45, 219, 39, 96]")
wait(5)

# Send the SU_DUMP command
cmd("UUT PAYLOAD_INMS_SU_DUMP_DIRECT_CMD with PKT_LEN 6, PAYLOAD_ID 2, CMD_ID 11, LENGTH 1, SEQ_CNT 3")
wait(5)

# Send the SU_HVARM command
cmd("UUT PAYLOAD_INMS_SU_HVARM_DIRECT_CMD with PKT_LEN 6, PAYLOAD_ID 2, CMD_ID 83, LENGTH 1, SEQ_CNT 4")
wait(5)

# Send the SU_HVON command
cmd("UUT PAYLOAD_INMS_SU_HVON_DIRECT_CMD with PKT_LEN 6, PAYLOAD_ID 2, CMD_ID 201, LENGTH 1, SEQ_CNT 5")
wait(10)

# Send the SU_HC command 
cmd("UUT PAYLOAD_INMS_SU_HC_DIRECT_CMD with PKT_LEN 9, PAYLOAD_ID 2, CMD_ID 6, LENGTH 4, SEQ_CNT 6, PARM1 28, PARM2 2, PARM3 32, PARM4 99, PARM5 238")
wait(10)

# Send the SU_HC command 
cmd("UUT PAYLOAD_INMS_SU_HC_DIRECT_CMD with PKT_LEN 9, PAYLOAD_ID 2, CMD_ID 6, LENGTH 4, SEQ_CNT 7, PARM1 28, PARM2 66, PARM3 32, PARM4 99, PARM5 238")
wait(10)

# Send the SU_HC command 
cmd("UUT PAYLOAD_INMS_SU_HC_DIRECT_CMD with PKT_LEN 9, PAYLOAD_ID 2, CMD_ID 6, LENGTH 4, SEQ_CNT 8, PARM1 28, PARM2 2, PARM3 32, PARM4 99, PARM5 238")
wait(10)

# Send the SU_CAL command
cmd("UUT PAYLOAD_INMS_SU_CAL_DIRECT_CMD with PKT_LEN 9, PAYLOAD_ID 2, CMD_ID 7, LENGTH 4, SEQ_CNT 9, PARM1 28, PARM2 2, PARM3 32, PARM4 99, PARM5 238")
wait(10)

# Send the SU_CAL command
cmd("UUT PAYLOAD_INMS_SU_CAL_DIRECT_CMD with PKT_LEN 9, PAYLOAD_ID 2, CMD_ID 7, LENGTH 4, SEQ_CNT 10, PARM1 28, PARM2 66, PARM3 32, PARM4 99, PARM5 238")
wait(10)

# Send the SU_CAL command
cmd("UUT PAYLOAD_INMS_SU_CAL_DIRECT_CMD with PKT_LEN 9, PAYLOAD_ID 2, CMD_ID 7, LENGTH 4, SEQ_CNT 11, PARM1 28, PARM2 2, PARM3 32, PARM4 99, PARM5 238")
wait(10)

# Send the SU_CAL command
cmd("UUT PAYLOAD_INMS_SU_CAL_DIRECT_CMD with PKT_LEN 9, PAYLOAD_ID 2, CMD_ID 7, LENGTH 4, SEQ_CNT 12, PARM1 28, PARM2 66, PARM3 32, PARM4 99, PARM5 238")
wait(10)

# Send the SU_CAL command
cmd("UUT PAYLOAD_INMS_SU_CAL_DIRECT_CMD with PKT_LEN 9, PAYLOAD_ID 2, CMD_ID 7, LENGTH 4, SEQ_CNT 13, PARM1 28, PARM2 2, PARM3 32, PARM4 99, PARM5 238")
wait(10)

# Send the SU_DUMP command
cmd("UUT PAYLOAD_INMS_SU_DUMP_DIRECT_CMD with PKT_LEN 6, PAYLOAD_ID 2, CMD_ID 11, LENGTH 1, SEQ_CNT 14")
wait(5)

# Send the SU_RESET command
cmd("UUT PAYLOAD_INMS_SU_RESET_DIRECT_CMD with PKT_LEN 6, PAYLOAD_ID 2, CMD_ID 2, LENGTH 1, SEQ_CNT 15")
wait(5)

# Send the SU_DUMP command
cmd("UUT PAYLOAD_INMS_SU_DUMP_DIRECT_CMD with PKT_LEN 6, PAYLOAD_ID 2, CMD_ID 11, LENGTH 1, SEQ_CNT 16")
wait(5)

# Send the SU_LDP command
cmd("UUT PAYLOAD_INMS_SU_LDP_DIRECT_CMD with PKT_LEN 56, PAYLOAD_ID 2, CMD_ID 5, LENGTH 51, SEQ_CNT 17, PARAM [119, 0, 2, 1, 10, 0, 2, 0, 113, 65, 18, 2, 20, 134, 232, 3, 232, 3, 64, 95, 9, 180, 0, 79, 10, 4, 0, 32, 3, 16, 99, 32, 32, 16, 59, 28, 66, 32, 32, 16, 59, 28, 66, 32, 212, 213, 45, 219, 39, 96]")
wait(5)

# Send the SU_DUMP command
cmd("UUT PAYLOAD_INMS_SU_DUMP_DIRECT_CMD with PKT_LEN 6, PAYLOAD_ID 2, CMD_ID 11, LENGTH 1, SEQ_CNT 18")
wait(5)

# Send the SU_HVARM command
cmd("UUT PAYLOAD_INMS_SU_HVARM_DIRECT_CMD with PKT_LEN 6, PAYLOAD_ID 2, CMD_ID 83, LENGTH 1, SEQ_CNT 19")
wait(5)

# Send the SU_HVON command
cmd("UUT PAYLOAD_INMS_SU_HVON_DIRECT_CMD with PKT_LEN 6, PAYLOAD_ID 2, CMD_ID 201, LENGTH 1, SEQ_CNT 20")
wait(10)

# Send the SU_HVON command
cmd("UUT PAYLOAD_INMS_SU_HVON_DIRECT_CMD with PKT_LEN 6, PAYLOAD_ID 2, CMD_ID 201, LENGTH 1, SEQ_CNT 21")
wait(10)

# Send the SU_DUMP command
cmd("UUT PAYLOAD_INMS_SU_DUMP_DIRECT_CMD with PKT_LEN 6, PAYLOAD_ID 2, CMD_ID 11, LENGTH 1, SEQ_CNT 22")
wait(5)

# Send the SU_SCI command
cmd("UUT PAYLOAD_INMS_SU_SCI_DIRECT_CMD with PKT_LEN 11, PAYLOAD_ID 2, CMD_ID 8, LENGTH 6, SEQ_CNT 23, PARM1 28, PARM2 2, PARM3 160, PARM4 5, RPT 20")
wait(365)

# Send the SU_SCI command
cmd("UUT PAYLOAD_INMS_SU_SCI_DIRECT_CMD with PKT_LEN 11, PAYLOAD_ID 2, CMD_ID 8, LENGTH 6, SEQ_CNT 24, PARM1 28, PARM2 66, PARM3 160, PARM4 5, RPT 20")
wait(365)

# Send the SU_SCI command
cmd("UUT PAYLOAD_INMS_SU_SCI_DIRECT_CMD with PKT_LEN 11, PAYLOAD_ID 2, CMD_ID 8, LENGTH 6, SEQ_CNT 25, PARM1 28, PARM2 2, PARM3 160, PARM4 5, RPT 20")
wait(365)

# Send the SU_SCI command
cmd("UUT PAYLOAD_INMS_SU_SCI_DIRECT_CMD with PKT_LEN 11, PAYLOAD_ID 2, CMD_ID 8, LENGTH 6, SEQ_CNT 26, PARM1 28, PARM2 66, PARM3 160, PARM4 5, RPT 20")
wait(365)

# Send the SU_SCI command
cmd("UUT PAYLOAD_INMS_SU_SCI_DIRECT_CMD with PKT_LEN 11, PAYLOAD_ID 2, CMD_ID 8, LENGTH 6, SEQ_CNT 27, PARM1 28, PARM2 2, PARM3 160, PARM4 5, RPT 20")
wait(365)

# Send the SU_DUMP command
cmd("UUT PAYLOAD_INMS_SU_DUMP_DIRECT_CMD with PKT_LEN 6, PAYLOAD_ID 2, CMD_ID 11, LENGTH 1, SEQ_CNT 28")
wait(5)

# Send the SU_LDP command
cmd("UUT PAYLOAD_INMS_SU_LDP_DIRECT_CMD with PKT_LEN 56, PAYLOAD_ID 2, CMD_ID 5, LENGTH 51, SEQ_CNT 29, PARAM [119, 0, 2, 1, 10, 0, 2, 0, 113, 65, 18, 2, 20, 134, 232, 3, 232, 3, 64, 95, 9, 180, 0, 79, 10, 4, 0, 32, 3, 16, 50, 16, 32, 16, 59, 28, 66, 32, 32, 16, 59, 28, 66, 32, 212, 213, 45, 219, 39, 96]")
wait(5)

# Send the SU_DUMP command
cmd("UUT PAYLOAD_INMS_SU_DUMP_DIRECT_CMD with PKT_LEN 6, PAYLOAD_ID 2, CMD_ID 11, LENGTH 1, SEQ_CNT 30")
wait(5)

# Send the SU_SCI command
cmd("UUT PAYLOAD_INMS_SU_SCI_DIRECT_CMD with PKT_LEN 11, PAYLOAD_ID 2, CMD_ID 8, LENGTH 6, SEQ_CNT 31, PARM1 28, PARM2 2, PARM3 208, PARM4 2, RPT 40")
wait(365)

# Send the SU_SCI command
cmd("UUT PAYLOAD_INMS_SU_SCI_DIRECT_CMD with PKT_LEN 11, PAYLOAD_ID 2, CMD_ID 8, LENGTH 6, SEQ_CNT 32, PARM1 28, PARM2 66, PARM3 208, PARM4 2, RPT 40")
wait(365)

# Send the SU_SCI command
cmd("UUT PAYLOAD_INMS_SU_SCI_DIRECT_CMD with PKT_LEN 11, PAYLOAD_ID 2, CMD_ID 8, LENGTH 6, SEQ_CNT 33, PARM1 28, PARM2 2, PARM3 208, PARM4 2, RPT 40")
wait(365)

# Send the SU_SCI command
cmd("UUT PAYLOAD_INMS_SU_SCI_DIRECT_CMD with PKT_LEN 11, PAYLOAD_ID 2, CMD_ID 8, LENGTH 6, SEQ_CNT 34, PARM1 28, PARM2 66, PARM3 208, PARM4 2, RPT 40")
wait(365)

# Send the SU_SCI command
cmd("UUT PAYLOAD_INMS_SU_SCI_DIRECT_CMD with PKT_LEN 11, PAYLOAD_ID 2, CMD_ID 8, LENGTH 6, SEQ_CNT 35, PARM1 28, PARM2 2, PARM3 208, PARM4 2, RPT 40")
wait(365)

# Send the SU_DUMP command
cmd("UUT PAYLOAD_INMS_SU_DUMP_DIRECT_CMD with PKT_LEN 6, PAYLOAD_ID 2, CMD_ID 11, LENGTH 1, SEQ_CNT 36")
wait(5)

# Send the SU_LDP command
cmd("UUT PAYLOAD_INMS_SU_LDP_DIRECT_CMD with PKT_LEN 56, PAYLOAD_ID 2, CMD_ID 5, LENGTH 51, SEQ_CNT 37, PARAM [119, 0, 2, 1, 10, 0, 2, 0, 113, 65, 18, 2, 20, 134, 232, 3, 232, 3, 64, 95, 9, 180, 0, 79, 10, 4, 0, 32, 3, 16, 10, 100, 32, 16, 59, 28, 66, 32, 32, 16, 59, 28, 66, 32, 212, 213, 45, 219, 39, 96]")
wait(5)

# Send the SU_DUMP command
cmd("UUT PAYLOAD_INMS_SU_DUMP_DIRECT_CMD with PKT_LEN 6, PAYLOAD_ID 2, CMD_ID 11, LENGTH 1, SEQ_CNT 38")
wait(5)

# Send the SU_SCI command
cmd("UUT PAYLOAD_INMS_SU_SCI_DIRECT_CMD with PKT_LEN 11, PAYLOAD_ID 2, CMD_ID 8, LENGTH 6, SEQ_CNT 39, PARM1 28, PARM2 2, PARM3 0, PARM4 0, RPT 24")
wait(725)

# Send the SU_SCI command
cmd("UUT PAYLOAD_INMS_SU_SCI_DIRECT_CMD with PKT_LEN 11, PAYLOAD_ID 2, CMD_ID 8, LENGTH 6, SEQ_CNT 40, PARM1 28, PARM2 66, PARM3 0, PARM4 0, RPT 24")
wait(725)

# Send the SU_SCI command
cmd("UUT PAYLOAD_INMS_SU_SCI_DIRECT_CMD with PKT_LEN 11, PAYLOAD_ID 2, CMD_ID 8, LENGTH 6, SEQ_CNT 41, PARM1 28, PARM2 2, PARM3 0, PARM4 0, RPT 24")
wait(725)

# Send the SU_SCI command
cmd("UUT PAYLOAD_INMS_SU_SCI_DIRECT_CMD with PKT_LEN 11, PAYLOAD_ID 2, CMD_ID 8, LENGTH 6, SEQ_CNT 42, PARM1 28, PARM2 66, PARM3 0, PARM4 0, RPT 24")
wait(725)

# Send the SU_SCI command
cmd("UUT PAYLOAD_INMS_SU_SCI_DIRECT_CMD with PKT_LEN 11, PAYLOAD_ID 2, CMD_ID 8, LENGTH 6, SEQ_CNT 43, PARM1 28, PARM2 2, PARM3 0, PARM4 0, RPT 24")
wait(725)

# Send the SU_DUMP command
cmd("UUT PAYLOAD_INMS_SU_DUMP_DIRECT_CMD with PKT_LEN 6, PAYLOAD_ID 2, CMD_ID 11, LENGTH 1, SEQ_CNT 44")
wait(5)

# Send the SU_RESET command
cmd("UUT PAYLOAD_INMS_SU_RESET_DIRECT_CMD with PKT_LEN 6, PAYLOAD_ID 2, CMD_ID 2, LENGTH 1, SEQ_CNT 45")
wait(5)

# Send the SU_DUMP command
cmd("UUT PAYLOAD_INMS_SU_DUMP_DIRECT_CMD with PKT_LEN 6, PAYLOAD_ID 2, CMD_ID 11, LENGTH 1, SEQ_CNT 46")
wait(5)

# Power off INMS
puts("Powering off the payload...")

cmd("UUT SET_LOAD_SWITCH with SWITCH_NUM IO7_OUT_INMS_3P3V, STATUS OFF")
cmd("UUT SET_LOAD_SWITCH with SWITCH_NUM IO17_OUT_INMS_5V, STATUS OFF")
wait_check("UUT POWER IO7_OUT_INMS_3P3V == 'OFF'", 5)
wait_check("UUT POWER IO17_OUT_INMS_5V == 'OFF'", 5)

puts("INMS has been powered off")
wait(5)

wait(5)

